# Changelog

## [0.2.0] - 2026-02-03
### Added
- 仕入品マスタに「管理/管理外」を導入。DB に `management_type` カラムを追加し、CSV の「管理/管理外」列をインポート。在庫一覧は「管理」のみ表示。
- データ管理の仕入品フォームに「管理/管理外」選択を追加。API（POST/PUT /api/items）で `management_type` を保存・更新。
- 履歴リセット用スクリプト `scripts/reset_inventory_history.py` を追加。`--yes` で確認なし実行可能。
- ナビゲーションに「履歴」を追加（データ管理の右）。履歴専用ページ `/history` を新設し、直近トランザクションを最大 50 件表示。
- データ管理の保存後ダイアログ：仕入品は追加時「品番○○追加完了」、編集時「品番○○ 発注点○→○へ変更完了」等を表示。仕入先は編集時「（担当者、電話を変更）」のように変更項目を表示。
- データ管理の仕入品検索でヒット後、結果カードへ自動スクロール。一覧カードクリック時はページ最上部へスクロール。
- データ管理の仕入先・仕入品一覧カードにマウスオーバー時のハイライト（在庫管理と同様の `hover:bg-slate-100`）を追加。

### Changed
- 在庫不足一覧（発注管理）の部署ツリーから、部署名横の「○カテゴリ」表示を削除。
- データ管理の仕入品編集で品名を不要に。品名未入力時は API 側で品番・種類で補完し、フォームから品名入力欄を削除。
- 在庫一覧で在庫数変更（モーダル確定）後、リロードなしで当該行の背景色（赤/解除）・差分表示・状態バッジを即時更新。
- 履歴表示を在庫一覧の下部から削除し、ナビの「履歴」から専用ページでのみ表示するように変更。在庫一覧のコンテキストから `recent_transactions` を削除。

## [0.1.1] - 2026-02-02
### Added
- 発注管理 `/orders` に在庫一覧と統一感のあるページ構成を導入し、左ペインに部署ツリー・highlightカード・在庫不足ハイライトカードのレイアウトを追加しました。

### Changed
- 差分 +0 も不足扱いの色（赤）に統一し、一覧のカード/hover 表示を在庫一覧と同じように調整しました。

### Fixed
- 低在庫候補のリストをカード化し、hover で強調表示されない問題を修正。これにより発注一覧のマウスオーバーで背景/境界が変化するようになりました。

## [0.1.0] - 2026-01-31
### Added
- 在庫一覧で `/inventory/inline-adjust` による +/- 調整と `/api/inventory/issues`、`/recent-transactions` API を導入し、中央ビュー・履歴を同期させた運用フローを構築。
- `manage_data` ページに仕入先/仕入品の検索付き編集フォームと `POST /api/suppliers` / `PUT /api/suppliers/{id}` / `POST /api/items` / `PUT /api/items/{id}` を実装し、CSV バッチなしでデータの追加・更新が可能に。
- 発注管理ページ `/orders` と `purchase_orders` 系テーブル／APIを追加し、発注登録・受領入力・ステータス更新・履歴記録を在庫トランザクションと連動させた仕組みを実現。
### Changed
- `/inventory/inline-adjust` は `tx_type=ADJUST` 固定・`reason` 任意化を明記し、既存の出庫/調整 API（および履歴取得）はそのまま保った上で UX をスムーズに。
- 管理画面では検索入力に `datalist` を追加して入力候補を表示、一覧クリックでフォームへスクロール、仕入先の全カラムを並べて UX を改善。
### Fixed
- `ZoneInfo("Asia/Tokyo")` 周りの `tzdata` 依存を満たし、直近履歴やダイアログのタイムスタンプを安定的に JST で表示できるように修正。
### Deps
- `requirements.txt` に `tzdata` / `python-multipart` を追加して zoneinfo/tzdata と multipart フォームの実行環境を整備。
